{"version":3,"sources":["appState.js","drawApi.js","screens/canvas/index.js","screens/canvas/CanvasPad.js","tools/toolpad_comp/PXSize.js","tools/toolpad_comp/DrawingTools.js","tools/toolpad_comp/ColorSwitcher.js","tools/ToolPad.js","tools/layerpad_comp/Player.js","tools/layerpad_comp/LayersList.js","tools/layerpad_comp/Layers.js","tools/layerpad_comp/LayerComposition.js","tools/layerpad_comp/Transform.js","tools/layerpad_comp/CanvasInfo.js","tools/LayerPad.js","tools/Menu.js","tools/ExportWindow.js","keyBind.js","tools/KeyBindWindow.js","components/frames.list/index.js","components/frames.list/FramePad.js","components/Login.js","components/HeadPad.js","Landing.js","App.js","index.js"],"names":["shortId","require","AppState","Object","classCallCheck","this","extendObservable","landing","size","scale","currentFrame","currentLayer","layers","pxSize","onionSkin","logIn","exportWindow","keyBindWindow","activeBindKey","target","tool","oldKey","compositeOperation","x","y","frames","addLayer","deleteLayerData","Frames","order","data","index","id","generate","Array","appState","fill","isArray","toConsumableArray","splice","push","indexOf","length","getCurrentData","up","currLayer","maxLayerLvl","next","_ref","startId","targetId","idx1","idx2","PlayerState","fps","timer","frameIdx","playerCnv","document","querySelector","clearInterval","setInterval","animate","bind","cnv","imgData","ctx","getContext","clearRect","width","height","globalCompositeOperation","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","done","layer","value","img","imagedataToImage","drawImage","err","return","imagedata","canvas","createElement","putImageData","image","Image","src","toDataURL","encoder","Encoder","name","backgroundColor","format","JSON","stringify","toJS","Blob","type","textFile","window","URL","createObjectURL","link","setAttribute","concat","click","imageSmoothingEnabled","framesArr","i","fillStyle","fillRect","getData","uintarr","getImageData","buffer","delay","delayMap","apng","UPNG","encode","console","log","createLink","Uint8Array","gif","GIFEncoder","setDelay","start","addFrame","finish","out","b64encoded","btoa","String","fromCharCode","apply","datajpg","hex","replace","m","r","g","b","substring","match","map","parseInt","join","playerState","drawApi","selectedTool","primaryColor","secondaryColor","toolSwitcher","e","pencil","eraser","smoothPencil","bucket","pickColor","sameColorPixel","drawLine","drawCircle","drawRectangle","move","dither","lighter","calcMousePos","nativeEvent","pixelX","offsetX","pixelY","offsetY","setCtxStyle","temp","which","strokeStyle","getColor","position","_drawApi","parentNode","color","rgbToHex","toString","destroy","onmousemove","onmouseup","updateCurrentFrame","drawFill","preventDefault","mouse","clearFill","drawMirrorFill","mirror","currentTarget","beginPath","lineWidth","moveTo","lineTo","stroke","startColor","stack","pop","col","row","endPos","startPos","drawCtx","drawCtxData","end","radiusX","radiusY","Math","abs","ellipse","PI","strokeRect","changeLight","ammount","ditherDraw","rotate","save","translate","restore","drawData","vertical","observable","CanvasPad","observer","_React$Component","props","_this","possibleConstructorReturn","getPrototypeOf","call","canvasPad","belowCnv","drawCnv","aboveCnv","glowCnv","cnvArr","handleWheel","assertThisInitialized","updateCnvArrScale","inherits","createClass","key","_this2","slice","curLayer","react_default","a","className","ref","pad","onContextMenu","handleBelowCanvasRender","style","opacity","handleDrawCanvasRender","handleAboveCanvasRender","onMouseDown","querySelectorAll","addEventListener","box","offsetHeight","offsetWidth","side","trunc","forEach","transform","ctrlKey","deltaY","React","Component","PXSize","arguments","data-size","onClick","handleClick","dataset","DrawingTools","ColorSwitcher","background","onInput","handleColor","handleColorSwitch","ToolPad","toolpad_comp_PXSize","toolpad_comp_DrawingTools","toolpad_comp_ColorSwitcher","Player","handleFullscreen","min","max","requestFullscreen","LayersList","data-layer","random","reverse","Layers","layerpad_comp_LayersList","deleteCurrentLayer","moveLayer","LayerComposition","onChange","handleInput","operator","Transform","CanvasInfo","LayerPad","layerpad_comp_Player","layerpad_comp_Layers","layerpad_comp_LayerComposition","layerpad_comp_Transform","layerpad_comp_CanvasInfo","Menu","handleChangeSize","handleExport","ExportWindow","handleClose","onSubmit","handleSubmit","htmlFor","handleNameChange","handleFormatChange","handleFPSChange","step","handleSizeChange","handleBackgroundColorChange","handleCloseWindow","exportGif","exportPSK","exportAPNG","classList","contains","keyBind","KeyBind","pen","mirrorPen","paintBucket","circle","rectangle","lightenDarken","colorPicker","smoothPen","KeyBindWindow","handleClosingClick","handleBindClick","data-key","data-tool","closest","onkeypress","stopPropagation","code","newKey","FramePad","number","draggable","handleFrameDiv","data-idx","handleCanvasRender","handleAddFrame","dropZone","ondragstart","event","getAttribute","ondragenter","parentElement","add","ondragleave","remove","ondragover","ondrop","div","switchFrames","frame","deleteFrame","responseGoogle","response","user","surname","imageUrl","Login","google_login","render","renderProps","disabled","buttonText","onLogoutSuccess","alt","clientId","onSuccess","resp","profileObj","givenName","familyName","onFailure","cookiePolicy","HeadPad","components_Login","Landing","Fragment","unload2","keyBindStr","localStorage","setItem","App","src_Landing","src_components_HeadPad","tools_ToolPad","frames_list","screens_canvas","src_tools_LayerPad","src_tools_Menu","src_tools_ExportWindow","src_tools_KeyBindWindow","keySwitcher","getItem","parse","prop","onunload","ReactDOM","src_App","getElementById"],"mappings":"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","file":"../../static/js/main.c3cba385.chunk.js","sourcesContent":["import { toJS } from 'mobx';\nimport UPNG from 'upng-js';\nimport { extendObservable } from 'mobx';\nimport GIFEncoder from 'gif-encoder-2';\nconst shortId = require('shortid');\n\nclass AppState {\n  constructor() {\n    extendObservable(this, {\n      landing: true,\n      size: 32,\n      scale: 20,\n      currentFrame: 0,\n      currentLayer: 0,\n      layers: 1,\n      pxSize: 1,\n      onionSkin: true,\n      logIn: false,\n      exportWindow: false,\n      keyBindWindow: false,\n      activeBindKey: { target: null, tool: null, oldKey: null },\n      compositeOperation: 'source-over',\n      x: 0,\n      y: 0,\n    });\n  }\n\n  addLayer() {\n    this.layers++;\n    this.currentLayer++;\n    frames.addLayer();\n  }\n\n  deleteCurrentLayer() {\n    frames.deleteLayerData();\n    if (this.layers > 1) this.layers--;\n    if (this.currentLayer > 0) {\n      this.currentLayer--;\n    }\n  }\n}\n\nclass Frames {\n  constructor() {\n    extendObservable(this, {\n      order: [],\n      data: {},\n    });\n    //[ID фреймов упорядоченные по кадрам]\n    //{ ID фрейма: массив ImageData объектов согласно Layer } \n  }\n\n  // data может быть как объектом, так и массивом объектов или null\n  // index передается для вставки элемента в центр массива\n  // если index не определен - в конец массива\n\n  addFrame(data, index) {\n    const id = shortId.generate();\n    if (!data) data = Array(appState.layers).fill(null);\n    data = Array.isArray(data) ? [...data] : [data];\n\n    this.data[id] = data;\n    index ? this.order.splice(index, 0, id) : this.order.push(id);\n\n    appState.currentFrame = this.order.indexOf(id);\n    return id;\n  }\n\n  deleteFrame(id) {\n    if (this.order.length === 1) {\n      const id = this.order[0];\n      this.data[id] = Array(appState.layers).fill(null);\n    } else {\n      const index = this.order.indexOf(id);\n      this.order.splice(index, 1);\n      delete this.data[id];\n    }\n    appState.currentFrame = 0;\n  }\n\n  updateCurrentFrame(data) {\n    const frame = this.getCurrentData();\n    frame[appState.currentLayer] = data;\n  }\n\n  getCurrentData() {\n    const id = this.order[appState.currentFrame];\n    return this.data[id];\n  }\n\n  getData(id) {\n    return this.data[id];\n  }\n\n  addLayer() {\n    for (let data in this.data) {\n      const layers = this.data[data];\n      layers.push(null);\n    }\n  }\n\n  moveLayer(up) {\n    const currLayer = appState.currentLayer;\n    const maxLayerLvl = appState.layers - 1;\n    if (up && currLayer === maxLayerLvl) return false;\n    if (!up && currLayer === 0) return false;\n    for (let data in this.data) {\n      const layers = this.data[data];\n      const next = up ? currLayer + 1 : currLayer - 1;\n      [layers[currLayer], layers[next]] = [layers[next], layers[currLayer]];\n    }\n    up ? appState.currentLayer++ : appState.currentLayer--;\n  }\n\n  deleteLayerData() {\n    for (let data in this.data) {\n      const layers = this.data[data];\n      layers.splice(appState.currentLayer, 1);\n    }\n  }\n\n  switchFrames(startId, targetId) {\n    if (startId === targetId) return;\n    const idx1 = this.order.indexOf(startId);\n    const idx2 = this.order.indexOf(targetId);\n    this.order[idx1] = targetId;\n    this.order[idx2] = startId;\n\n  }\n};\n\nclass PlayerState {\n  constructor() {\n    extendObservable(this, {\n      fps: 24,\n      timer: null,\n      frameIdx: 0,\n    });\n  }\n\n  start() {\n    const playerCnv = document.querySelector('.player-canvas');\n    clearInterval(this.timer);\n    this.timer = setInterval(this.animate.bind(this, playerCnv), 1000 / this.fps)\n  }\n\n  animate(cnv) {\n    if (this.frameIdx >= frames.order.length) this.frameIdx = 0;\n    let id = frames.order[this.frameIdx];\n\n    const imgData = frames.data[id];\n    const ctx = cnv.getContext('2d');\n    ctx.clearRect(0, 0, cnv.width, cnv.height);\n    ctx.globalCompositeOperation = appState.compositeOperation;\n\n    for (let layer of imgData) {\n      if (layer == null) continue;\n      const img = this.imagedataToImage(layer);\n      ctx.drawImage(img, 0, 0);\n    }\n    this.frameIdx++;\n  }\n\n  imagedataToImage(imagedata) {\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n    canvas.width = imagedata.width;\n    canvas.height = imagedata.height;\n    ctx.putImageData(imagedata, 0, 0);\n\n    var image = new Image();\n    image.src = canvas.toDataURL();\n    return image;\n  }\n}\n\nclass Encoder {\n  constructor() {\n    extendObservable(this, {\n      fps: 24,\n      name: 'new',\n      backgroundColor: null,\n      format: 'gif',\n      size: 32,\n    });\n  }\n\n  async exportPSK() {\n    const img = JSON.stringify(toJS(frames));\n    const data = new Blob([img], { type: 'text/plain' });\n    const textFile = window.URL.createObjectURL(data);\n\n    const link = document.createElement('a');\n    link.setAttribute('href', textFile);\n    link.setAttribute('download', `${this.name}.${this.format}`);\n    link.click();\n  }\n\n  async exportAPNG() {\n    const cnv = document.createElement('canvas');\n    const size = this.size;\n    cnv.width = size;\n    cnv.height = size;\n    const ctx = cnv.getContext('2d');\n    ctx.imageSmoothingEnabled = false;\n    ctx.globalCompositeOperation = appState.compositeOperation;\n\n    const framesArr = [];\n\n    for (let i = 0; i < frames.order.length; i++) {\n      if (this.backgroundColor) {\n        ctx.fillStyle = this.backgroundColor;\n        ctx.fillRect(0, 0, size, size);\n      }\n\n      const id = frames.order[i];\n      const data = frames.getData(id);\n\n      for (let layer of data) {\n        if (!layer) continue;\n        const img = this.imagedataToImage(layer);\n        ctx.drawImage(img, 0, 0, size, size);\n      }\n\n      const uintarr = ctx.getImageData(0, 0, size, size).data;\n\n      framesArr.push(uintarr.buffer);\n      ctx.clearRect(0, 0, size, size);\n    }\n\n    const delay = 1000 / this.fps;\n    const delayMap =  Array(framesArr.length).fill(delay);\n\n    \n    const apng = UPNG.encode(framesArr, this.size, this.size, 0, delayMap);\n\n    console.log('raw', apng);\n    const link = this.createLink(new Uint8Array(apng), this.name);\n    link.click();\n  }\n\n  async exportGif() {\n    const cnv = document.createElement('canvas');\n    const size = this.size;\n    cnv.width = size;\n    cnv.height = size;\n    const ctx = cnv.getContext('2d');\n    ctx.imageSmoothingEnabled = false;\n    ctx.globalCompositeOperation = appState.compositeOperation;\n    const gif = new GIFEncoder(size, size);\n\n    gif.setDelay(1000 / this.fps);\n    gif.start();\n    for (let i = 0; i < frames.order.length; i++) {\n      if (this.backgroundColor) {\n        ctx.fillStyle = this.backgroundColor;\n        ctx.fillRect(0, 0, size, size);\n      }\n\n      const id = frames.order[i];\n      const data = frames.getData(id);\n\n      for (let layer of data) {\n        if (!layer) continue;\n        const img = this.imagedataToImage(layer);\n        ctx.drawImage(img, 0, 0, size, size);\n      }\n\n      gif.addFrame(ctx);\n      ctx.clearRect(0, 0, size, size);\n    }\n\n    gif.finish();\n    const buffer = gif.out.getData();\n    console.log(buffer);\n    const link = this.createLink(buffer);\n    link.click();\n  }\n\n  createLink(buffer) {\n    const b64encoded = btoa(String.fromCharCode.apply(null, buffer));\n    const datajpg = `data:image/jpg;base64,${b64encoded}`;\n\n    const link = document.createElement('a');\n    link.setAttribute('href', datajpg);\n    link.setAttribute('download', `${this.name}.${this.format}`);\n\n    return link;\n  }\n\n  hexToRgb(hex) {\n    console.log(hex);\n    hex.replace(/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i, (m, r, g, b) => `#${r}${r}${g}${g}${b}${b}`)\n      .substring(1).match(/.{2}/g)\n      .map(x => parseInt(x, 16))\n      .join();\n    console.log(hex);\n    return hex;\n  }\n\n  imagedataToImage(imagedata) {\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n    canvas.width = imagedata.width;\n    canvas.height = imagedata.height;\n    ctx.putImageData(imagedata, 0, 0);\n\n    var image = new Image();\n    image.src = canvas.toDataURL();\n    return image;\n  }\n}\n\nconst encoder = new Encoder();\n\nconst frames = new Frames();\n\nconst appState = new AppState();\n\nconst playerState = new PlayerState();\n\nexport { appState, frames, playerState, encoder };\n","import { observable } from 'mobx';\nimport { appState, frames, playerState } from './appState';\n\nlet drawApi = {\n  pxSize: 1,\n  selectedTool: 'pen',\n  primaryColor: '#00ffff',\n  secondaryColor: '#ff00ff',\n\n  toolSwitcher(e) {\n\n    switch (drawApi.selectedTool) {\n      case 'pen':\n        drawApi.pencil(e, false);\n        break;\n\n      case 'mirror-pen':\n        drawApi.pencil(e, true);\n        break;\n\n      case 'eraser':\n        drawApi.eraser(e);\n        break;\n\n      case 'smooth-pen':\n        drawApi.smoothPencil(e);\n        break;\n\n      case 'paint-bucket':\n        drawApi.bucket(e);\n        break;\n\n      case 'color-picker':\n        drawApi.pickColor(e);\n        break;\n\n      case 'same-color-pixel':\n        drawApi.sameColorPixel(e);\n        break;\n\n      case 'stroke':\n        drawApi.drawLine(e);\n        break;\n\n      case 'circle':\n        drawApi.drawCircle(e);\n        break;\n\n      case 'rectangle':\n        drawApi.drawRectangle(e);\n        break;\n\n      case 'move':\n        drawApi.move(e);\n        break;\n\n      case 'dither':\n        drawApi.dither(e);\n        break;\n\n      case 'lighten-darken':\n        drawApi.lighter(e);\n        break;\n\n      default:\n        break;\n    }\n  },\n\n  calcMousePos(e) {\n    if (e.nativeEvent) e = e.nativeEvent;\n    const pixelX = e.offsetX;\n    const pixelY = e.offsetY;\n    console.log(pixelX, pixelY);\n    return { x: pixelX, y: pixelY };\n  },\n\n  setCtxStyle(e, ctx, fill) {\n    if (e.nativeEvent) e = e.nativeEvent;\n    let temp;\n\n    if (e.which === 1) {\n      temp = drawApi.primaryColor;\n    } else if (e.which === 3) {\n      temp = drawApi.secondaryColor;\n    } else return false;\n\n    if (fill) {\n      ctx.fillStyle = temp;\n    } else {\n      ctx.strokeStyle = temp;\n    }\n\n    return true;\n  },\n\n  getColor(e, position) {\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n\n    if (!position) position = { x: e.offsetX, y: e.offsetY };\n\n    const color = ctx.getImageData(position.x, position.y, 1, 1);\n\n    return drawApi.rgbToHex(...color.data);\n  },\n\n  rgbToHex(r, g, b) {\n    r = r.toString(16);\n    g = g.toString(16);\n    b = b.toString(16);\n\n    if (r.length === 1) r = '0' + r;\n    if (g.length === 1) g = '0' + g;\n    if (b.length === 1) b = '0' + b;\n\n    return `#${(r + g + b)}`;\n  },\n\n  destroy(e) {\n    if (e.nativeEvent) e = e.nativeEvent;\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n    document.querySelector('.pixel-glow-canvas').onmousemove = null;\n    window.onmouseup = null;\n    const data = ctx.getImageData(0, 0, appState.size, appState.size);\n    frames.updateCurrentFrame(data);\n  },\n\n  imagedataToImage(imagedata) {\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    canvas.width = imagedata.width;\n    canvas.height = imagedata.height;\n    ctx.putImageData(imagedata, 0, 0);\n\n    const image = new Image();\n    image.src = canvas.toDataURL();\n    return image;\n  },\n\n  drawFill(e) {\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n    e.preventDefault();\n\n    if (!drawApi.setCtxStyle(e, ctx, true)) return false;\n\n    let mouse = drawApi.calcMousePos(e);\n\n    if (drawApi.pxSize > 2) {\n      ctx.fillRect(mouse.x - 2, mouse.y - 2, drawApi.pxSize, drawApi.pxSize)\n    } else {\n      ctx.fillRect(mouse.x, mouse.y - 1, drawApi.pxSize, drawApi.pxSize);\n    }\n  },\n\n  clearFill(e) {\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n\n    let mouse = drawApi.calcMousePos(e);\n\n    if (drawApi.pxSize > 2) {\n      ctx.clearRect(mouse.x - 2, mouse.y - 2, drawApi.pxSize, drawApi.pxSize)\n    } else {\n      ctx.clearRect(mouse.x, mouse.y - 1, drawApi.pxSize, drawApi.pxSize);\n    }\n  },\n\n  drawMirrorFill(e) {\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n    e.preventDefault();\n\n    if (!drawApi.setCtxStyle(e, ctx, true)) return false;\n\n    let mouse = drawApi.calcMousePos(e);\n\n    if (drawApi.pxSize > 2) {\n      ctx.fillRect(mouse.x - 2, mouse.y - 2, drawApi.pxSize, drawApi.pxSize);\n      ctx.fillRect(appState.size - mouse.x - 1, mouse.y - 2, drawApi.pxSize, drawApi.pxSize)\n    } else {\n      ctx.fillRect(mouse.x - 1, mouse.y - 1, drawApi.pxSize, drawApi.pxSize);\n      ctx.fillRect(appState.size - mouse.x, mouse.y - 1, drawApi.pxSize, drawApi.pxSize);\n    }\n  },\n\n  pencil(e, mirror) {\n    e.preventDefault();\n\n    mirror ? drawApi.drawMirrorFill(e) : drawApi.drawFill(e);\n\n    e.currentTarget.onmousemove = mirror ? drawApi.drawMirrorFill : drawApi.drawFill;\n\n    window.onmouseup = drawApi.destroy;\n  },\n\n  smoothPencil(e) {\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n    e.preventDefault();\n\n    ctx.beginPath();\n    if (!drawApi.setCtxStyle(e, ctx, false)) return false;\n\n    ctx.lineWidth = drawApi.pxSize;\n    ctx.moveTo(e.offsetX, e.offsetY);\n    ctx.lineTo(e.offsetX, e.offsetY);\n    ctx.stroke();\n\n    e.currentTarget.onmousemove = e => {\n      ctx.lineTo(e.offsetX, e.offsetY);\n      ctx.stroke();\n    };\n\n    window.onmouseup = drawApi.destroy;\n  },\n\n  eraser(e) {\n    e.preventDefault();\n\n    drawApi.clearFill(e);\n\n    e.currentTarget.onmousemove = drawApi.clearFill;\n\n    window.onmouseup = drawApi.destroy;\n  },\n\n  bucket(e) {\n    if (e.nativeEvent) e = e.nativeEvent;\n\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n\n    if (!drawApi.setCtxStyle(e, ctx, true)) return false;\n\n    const mouse = drawApi.calcMousePos(e);\n    const curFrame = frames.getCurrentData();\n\n    if (!curFrame[appState.currentLayer]) {\n      ctx.fillRect(0, 0, appState.size, appState.size);\n    } else {\n      const startColor = drawApi.getColor(e, mouse);\n\n      if (startColor === ctx.fillStyle) return;\n\n      const stack = [mouse];\n\n      while (stack.length) {\n        const position = stack.pop();\n        const x = position.x;\n        const y = position.y;\n\n        if ((x >= 0 && x < appState.size) && (y >= 0 && y < appState.size)) {\n          const currentColor = drawApi.getColor(e, position);\n          if (startColor === currentColor) {\n            ctx.fillRect(x, y, 1, 1);\n            stack.push({ x: x - 1, y: y }, { x: x + 1, y: y }, { x: x, y: y - 1 }, { x: x, y: y + 1 });\n          }\n        }\n      }\n    }\n\n    const data = ctx.getImageData(0, 0, appState.size, appState.size);\n    frames.updateCurrentFrame(data);\n  },\n\n  sameColorPixel(e) {\n    if (e.nativeEvent) e = e.nativeEvent;\n\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n\n    if (!drawApi.setCtxStyle(e, ctx, true)) return false;\n\n    const mouse = drawApi.calcMousePos(e);\n    const curFrame = frames.getCurrentData();\n\n    if (!curFrame[appState.currentLayer]) {\n      ctx.fillRect(0, 0, appState.size, appState.size);\n    } else {\n      const startColor = drawApi.getColor(e, mouse);\n\n      if (startColor === ctx.fillStyle) return;\n\n      for (let col = 0; col < appState.size; col++) {\n        for (let row = 0; row < appState.size; row++) {\n          const color = drawApi.getColor(e, { x: row, y: col });\n          if (startColor === color) {\n            ctx.fillRect(row, col, 1, 1);\n          }\n        }\n      }\n    }\n\n    const data = ctx.getImageData(0, 0, appState.size, appState.size);\n    frames.updateCurrentFrame(data);\n  },\n\n  pickColor(e) {\n    if (e.nativeEvent) e = e.nativeEvent;\n\n    const color = drawApi.getColor(e);\n\n    if (e.which === 1) {\n      drawApi.primaryColor = color;\n    } else if (e.which === 3) {\n      drawApi.secondaryColor = color;\n    } else return;\n  },\n\n  drawLine(e) {\n    const cnv = e.currentTarget;\n    const ctx = cnv.getContext('2d');\n\n    const startPos = drawApi.calcMousePos(e);\n    let endPos;\n\n    if (!drawApi.setCtxStyle(e, ctx, false)) return false;\n    ctx.lineWidth = drawApi.pxSize;\n\n    cnv.onmousemove = (e) => {\n      ctx.clearRect(0, 0, appState.size, appState.size);\n      ctx.beginPath();\n      ctx.moveTo(startPos.x, startPos.y);\n\n      endPos = drawApi.calcMousePos(e);\n      ctx.lineTo(endPos.x, endPos.y);\n      ctx.stroke();\n    }\n\n    window.onmouseup = (e) => {\n      cnv.onmousemove = null;\n      window.onmouseup = null;\n\n      ctx.clearRect(0, 0, appState.size, appState.size);\n\n      const drawCnv = e.target.parentNode.querySelector('.draw-canvas');\n      const drawCtx = drawCnv.getContext('2d');\n      if (!drawApi.setCtxStyle(e, drawCtx, false)) return false;\n      drawCtx.lineWidth = drawApi.pxSize;\n\n      drawCtx.beginPath();\n      drawCtx.moveTo(startPos.x, startPos.y);\n\n      drawCtx.lineTo(endPos.x, endPos.y);\n      drawCtx.stroke();\n\n      const drawCtxData = drawCtx.getImageData(0, 0, appState.size, appState.size);\n      frames.updateCurrentFrame(drawCtxData);\n    }\n  },\n\n  drawCircle(e) {\n    const cnv = e.currentTarget;\n    const ctx = cnv.getContext('2d');\n\n    const startPos = drawApi.calcMousePos(e);\n    const x = startPos.x;\n    const y = startPos.y;\n    let end;\n    let radiusX;\n    let radiusY;\n\n    if (!drawApi.setCtxStyle(e, ctx, false)) return false;\n    ctx.lineWidth = drawApi.pxSize;\n\n    cnv.onmousemove = (e) => {\n      ctx.clearRect(0, 0, appState.size, appState.size);\n      end = drawApi.calcMousePos(e);\n\n      radiusX = Math.abs(end.x - x);\n      radiusY = Math.abs(end.y - y)\n\n      ctx.beginPath();\n      ctx.ellipse(x, y, radiusX, radiusY, 0, 0, 2 * Math.PI);\n\n      ctx.stroke();\n    }\n\n    window.onmouseup = (e) => {\n      cnv.onmousemove = null;\n      window.onmouseup = null;\n\n      ctx.clearRect(0, 0, appState.size, appState.size);\n\n      const drawCnv = e.target.parentNode.querySelector('.draw-canvas');\n      const drawCtx = drawCnv.getContext('2d');\n      if (!drawApi.setCtxStyle(e, drawCtx, false)) return false;\n      drawCtx.lineWidth = drawApi.pxSize;\n\n      drawCtx.beginPath();\n      for (let i = 0; i < 3; i++) {\n        drawCtx.ellipse(x, y, radiusX, radiusY, 0, 0, 2 * Math.PI);\n      }\n      drawCtx.stroke();\n\n      const drawCtxData = drawCtx.getImageData(0, 0, appState.size, appState.size);\n      frames.updateCurrentFrame(drawCtxData);\n    }\n  },\n\n  drawRectangle(e) {\n    const cnv = e.currentTarget;\n    const ctx = cnv.getContext('2d');\n\n    const startPos = drawApi.calcMousePos(e);\n    const x = startPos.x;\n    const y = startPos.y;\n    let end;\n\n    if (!drawApi.setCtxStyle(e, ctx, false)) return false;\n    ctx.lineWidth = drawApi.pxSize;\n\n    cnv.onmousemove = (e) => {\n      ctx.clearRect(0, 0, appState.size, appState.size);\n      end = drawApi.calcMousePos(e);\n\n      ctx.beginPath();\n      ctx.strokeRect(x, y, end.x - x, end.y - y);\n    }\n\n    window.onmouseup = (e) => {\n      cnv.onmousemove = null;\n      window.onmouseup = null;\n\n      ctx.clearRect(0, 0, appState.size, appState.size);\n\n      const drawCnv = e.target.parentNode.querySelector('.draw-canvas');\n      const drawCtx = drawCnv.getContext('2d');\n      if (!drawApi.setCtxStyle(e, drawCtx, false)) return false;\n      drawCtx.lineWidth = drawApi.pxSize;\n\n      drawCtx.beginPath();\n      for (let i = 0; i < 3; i++) {\n        drawCtx.strokeRect(x, y, end.x - x, end.y - y);\n      }\n\n      const drawCtxData = drawCtx.getImageData(0, 0, appState.size, appState.size);\n      frames.updateCurrentFrame(drawCtxData);\n    }\n  },\n\n  move(e) {\n    if (e.nativeEvent) e = e.nativeEvent;\n\n    const drawCnv = e.target.parentNode.querySelector('.draw-canvas');\n    const drawCtx = drawCnv.getContext('2d');\n\n    const data = drawCtx.getImageData(0, 0, appState.size, appState.size);\n    const start = drawApi.calcMousePos(e);\n    let end;\n\n    e.target.onmousemove = (e) => {\n      drawCtx.clearRect(0, 0, appState.size, appState.size);\n      end = drawApi.calcMousePos(e);\n      drawCtx.putImageData(data, end.x - start.x, end.y - start.y);\n    }\n\n    window.onmouseup = drawApi.destroy;\n  },\n\n  lighter(e) {\n\n    drawApi.changeLight(e);\n\n    e.currentTarget.onmousemove = drawApi.changeLight;\n\n    window.onmouseup = drawApi.destroy;\n  },\n\n  changeLight(e) {\n    if (e.nativeEvent) e = e.nativeEvent;\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n\n    const mouse = drawApi.calcMousePos(e);\n    let x;\n    let y;\n    if (drawApi.pxSize > 2) {\n      x = mouse.x - 2;\n      y = mouse.y - 2;\n    } else {\n      x = mouse.x;\n      y = mouse.y - 1;\n    }\n\n    const layer = ctx.getImageData(x, y, drawApi.pxSize, drawApi.pxSize);\n    const data = layer.data;\n    let ammount;\n\n    if (e.which === 1) {\n      ammount = 2;\n    } else if (e.which === 3) {\n      ammount = -2;\n    } else return false;\n\n    for (let i = 0; i < layer.data.length; i += 4) {\n      data[i] += ammount;\n      data[i + 1] += ammount;\n      data[i + 2] += ammount;\n    }\n\n    ctx.putImageData(layer, x, y);\n  },\n\n  dither(e) {\n    drawApi.ditherDraw(e);\n\n    e.currentTarget.onmousemove = drawApi.ditherDraw;\n\n    window.onmouseup = drawApi.destroy;\n  },\n\n  ditherDraw(e) {\n    if (e.nativeEvent) e = e.nativeEvent;\n    const cnv = e.target.parentNode.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n\n    const mouse = drawApi.calcMousePos(e);\n    \n    drawApi.setCtxStyle(e, ctx, true);\n\n    if((mouse.x + mouse.y) % 2) {\n      ctx.fillRect(mouse.x, mouse.y, 1, 1);\n    } else {\n      ctx.clearRect(mouse.x, mouse.y, 1, 1);\n    }\n  },\n\n  rotate() {\n    const cnv = document.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n  \n    const length = appState.size / 2;\n    ctx.save();\n    ctx.translate(length, length); // translate to rectangle center \n    ctx.rotate(Math.PI * 3 / 2); // rotate\n    ctx.translate(-length, -length);\n\n    const data = frames.getCurrentData();\n\n    const img = playerState.imagedataToImage(data[appState.currentLayer]);\n    ctx.clearRect(0, 0, appState.size, appState.size);\n    ctx.drawImage(img, 0, 0);\n\n    ctx.restore();\n    const drawData = ctx.getImageData(0, 0, appState.size, appState.size);\n    frames.updateCurrentFrame(drawData);\n  },\n\n  mirror(vertical) {\n    const cnv = document.querySelector('.draw-canvas');\n    const ctx = cnv.getContext('2d');\n\n    ctx.save();\n\n    vertical ? ctx.translate(appState.size, 0) : ctx.translate(0, appState.size); \n    vertical ? ctx.scale(-1, 1) : ctx.scale(1, -1);\n\n    const data = frames.getCurrentData();\n\n    const img = playerState.imagedataToImage(data[appState.currentLayer]);\n    ctx.clearRect(0, 0, appState.size, appState.size);\n    ctx.drawImage(img, 0, 0);\n\n    ctx.restore();\n    const drawData = ctx.getImageData(0, 0, appState.size, appState.size);\n    frames.updateCurrentFrame(drawData);\n  },\n}\n\ndrawApi = observable(drawApi);\n\nexport default drawApi;\n","import CanvasPad from './CanvasPad';\r\n\r\nexport default CanvasPad;\r\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { appState, frames } from '../../appState';\nimport drawApi from '../../drawApi';\n\nconst CanvasPad = observer(\n  class CanvasPad extends React.Component {\n    constructor(props) {\n      super(props);\n      this.canvasPad = null;\n      this.belowCnv = null;\n      this.drawCnv = null;\n      this.aboveCnv = null;\n      this.glowCnv = null;\n      this.cnvArr = null;\n\n      this.handleWheel = this.handleWheel.bind(this);\n      this.updateCnvArrScale = this.updateCnvArrScale.bind(this);\n    }\n\n    render() {\n      console.log(appState.size,\n        appState.currentLayer,\n        appState.currentFrame,\n        JSON.stringify(frames.data).slice(0, 0));\n      this.updateCnvArrScale();\n      const curLayer = appState.currentLayer;\n      return (\n        <div\n          className=\"canvas-pad\"\n          ref={(pad) => { this.canvasPad = pad }}\n          onContextMenu={e => e.preventDefault()}\n        >\n          <canvas\n            className=\"background-canvas\"\n            width={appState.size}\n            height={appState.size}\n          >\n          </canvas>\n          <canvas\n            className=\"layers-below-canvas\"\n            width={appState.size}\n            height={appState.size}\n            ref={(cnv) => {\n              this.belowCnv = cnv;\n              this.handleBelowCanvasRender(cnv, curLayer);\n            }}\n            style={{opacity: appState.onionSkin ? 0.4 : 0}}\n          >\n          </canvas>\n          <canvas\n            width={appState.size}\n            height={appState.size}\n            className='draw-canvas'\n            ref={(cnv) => {\n              this.drawCnv = cnv;\n              this.handleDrawCanvasRender(cnv, curLayer);\n            }}\n          >\n          </canvas>\n          <canvas\n            className=\"layers-above-canvas\"\n            width={appState.size}\n            height={appState.size}\n            ref={(cnv) => {\n              this.aboveCnv = cnv;\n              this.handleAboveCanvasRender(cnv, curLayer);\n            }}\n            style={{opacity: appState.onionSkin ? 0.4 : 0 }}\n          >\n          </canvas>\n          <canvas\n            className=\"pixel-glow-canvas\"\n            width={appState.size}\n            height={appState.size}\n            onMouseDown={drawApi.toolSwitcher}\n            ref={(cnv) => { this.glowCnv = cnv; }}\n          >\n          </canvas>\n        </div>\n      );\n    }\n\n    handleBelowCanvasRender(cnv, currentLayer) {\n      if (!cnv) return;\n      const ctx = cnv.getContext('2d');\n      ctx.globalCompositeOperation = 'source-over';\n      ctx.clearRect(0, 0, cnv.width, cnv.height);\n      const data = frames.getCurrentData();\n      for(let i = 0; i < currentLayer; i++) { \n        if (!data[i]) continue;\n        const img = drawApi.imagedataToImage(data[i]);\n        ctx.drawImage(img, 0, 0);\n      }\n    }\n\n    handleDrawCanvasRender(cnv, currentLayer) {\n      if (!cnv) return;\n      const ctx = cnv.getContext('2d');\n      ctx.clearRect(0, 0, cnv.width, cnv.height);\n      const data = frames.getCurrentData();\n      const curLayer = data[currentLayer];\n      if(!curLayer) return;\n      ctx.putImageData(curLayer, 0, 0);\n    }\n\n    handleAboveCanvasRender(cnv, currentLayer) {\n      if (!cnv) return;\n      const ctx = cnv.getContext('2d');\n      ctx.globalCompositeOperation = 'source-over';\n      ctx.clearRect(0, 0, cnv.width, cnv.height);\n      const data = frames.getCurrentData();\n      for(let i = currentLayer + 1; i < data.length; i++) { \n        if (!data[i]) continue;\n        const img = drawApi.imagedataToImage(data[i]);\n        ctx.drawImage(img, 0, 0);\n      }\n    }\n\n    componentDidMount() {\n      // this.canvasPad = document.querySelector('.canvas-pad');\n      this.cnvArr = this.canvasPad.querySelectorAll('canvas');\n      this.updateCnvArrScale();\n      this.canvasPad.addEventListener('wheel', this.handleWheel, false);\n      this.glowCnv.addEventListener('mousemove', (e) => {\n        appState.x = e.offsetX;\n        appState.y = e.offsetY;\n      });\n    }\n\n    updateCnvArrScale() {\n      if (!this.drawCnv) return;\n\n      let box = this.canvasPad;\n\n      if (appState.scale <= 1) {\n        appState.scale = 1;\n      }\n\n      if (appState.scale * appState.size > box.offsetHeight\n        || appState.scale * appState.size > box.offsetWidth) {\n        const side = box.offsetHeight >= box.offsetWidth\n          ? box.offsetWidth\n          : box.offsetHeight;\n        appState.scale = Math.trunc(side / appState.size);\n      }\n\n      this.cnvArr.forEach(cnv => {\n        cnv.style.transform = 'scale(' + appState.scale + ')';\n      });\n    }\n\n    handleWheel(e) {\n      if (e.ctrlKey) {\n        e.preventDefault();\n        appState.scale += e.deltaY > 0 ? -2 : 2;\n        this.updateCnvArrScale();\n      }\n    }\n  }\n);\n\nexport default CanvasPad;\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport drawApi from '../../drawApi';\n\nconst PXSize = observer(\n  class PXSize extends React.Component {\n    \n    render() {\n      return (\n        <div \n          className=\"pixel-size\"\n        >\n          {[1, 2, 3, 4].map(size => \n              <div \n                data-size={size} \n                className={size === drawApi.pxSize ? 'selected' : ''}\n                onClick={this.handleClick}\n                key={size}\n              >\n                <div className={'size-' + size}></div>\n              </div>\n          )}\n        </div>\n      );\n    }\n\n    handleClick(e) {\n      const target = e.currentTarget;\n      drawApi.pxSize = +target.dataset.size;\n    }\n  }\n);\n\nexport default PXSize;\n","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport drawApi from '../../drawApi';\r\n\r\nconst DrawingTools = observer(\r\n  class DrawingTools extends React.Component {\r\n    render() {\r\n      const tools = [\r\n        'pen',\r\n        'mirror-pen',\r\n        'paint-bucket',\r\n        'same-color-pixel',\r\n        'eraser',\r\n        'stroke',\r\n        'circle',\r\n        'rectangle',\r\n        'move',\r\n        'lighten-darken',\r\n        'dither',\r\n        'color-picker',\r\n        'smooth-pen',\r\n      ];\r\n      return (\r\n        <ul \r\n          className=\"drawing-tools\"\r\n          onClick={this.handleClick}\r\n        >\r\n          {tools.map((tool, id) => \r\n            <li \r\n              className={tool + (tool === drawApi.selectedTool ? ' selected' : '')}\r\n              key={id}\r\n            ></li>\r\n          )}\r\n        </ul>\r\n      );\r\n    }\r\n\r\n    handleClick(e) {\r\n      if(e.target.className === 'drawing-tools') return;\r\n      drawApi.selectedTool = e.target.className;\r\n    }\r\n  }\r\n);\r\nexport default DrawingTools;\r\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport drawApi from '../../drawApi';\n\nconst ColorSwitcher = observer(\n  class ColorSwitcher extends React.Component {\n    \n    render() {\n      return (\n        <div className=\"color-switcher\">\n          <label \n            className=\"primary-color\" \n            style={{ background: drawApi.primaryColor }}\n          >\n            <input\n              type=\"color\"\n              name=\"primary\"\n              id=\"primary\"\n              onInput={this.handleColor}\n            />\n          </label>\n          <label \n            className=\"secondary-color\"\n            style={{ background: drawApi.secondaryColor }}\n          >\n            <input \n              type=\"color\" \n              name=\"secondary\" \n              id=\"secondary\"\n              onInput={this.handleColor}\n            />\n          </label>\n          <button id='switch-colors' onClick={this.handleColorSwitch}></button>\n        </div>\n      );\n    }\n\n    handleColor(e) {\n      drawApi[`${e.currentTarget.id}Color`] = e.currentTarget.value;\n    }\n\n    handleColorSwitch() {\n      [ drawApi.primaryColor, drawApi.secondaryColor ] = [ drawApi.secondaryColor, drawApi.primaryColor ];\n    }\n  }\n);\n\nexport default ColorSwitcher;\n","import React from 'react';\nimport { PXSize, DrawingTools, ColorSwitcher } from './toolpad_comp/';\nimport { observer } from 'mobx-react';\nimport { appState } from '../appState';\n\nconst ToolPad = observer(\n  class ToolPad extends React.Component {\n    render() {\n      return (\n        <section className=\"tool-pad\">\n          <PXSize />\n          <DrawingTools />\n          <ColorSwitcher />\n          <button \n            className=\"key-bind-button\"\n            onClick={() => { appState.keyBindWindow = true }}\n          ></button>\n        </section>\n      );\n    }\n  }\n);\n\nexport default ToolPad;\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { appState, playerState } from '../../appState';\n\nconst Player = observer(\n  class Player extends React.Component {\n    render() {\n      return (\n        <div className=\"player\">\n          <div className=\"player-canvas-container\">\n            <canvas\n              className=\"player-canvas\"\n              width={appState.size}\n              height={appState.size}\n            >\n            </canvas>\n          </div>\n          <div className=\"player-controls\">\n            <button \n              className=\"fullscreen\"\n              onClick={this.handleFullscreen}\n            >&#9645;\n            </button>\n            <div className=\"player-fps\">FPS{playerState.fps}</div>\n            <input\n              type=\"range\"\n              name=\"input-fps\"\n              id=\"input-fps\"\n              min={1}\n              max={24}\n              onInput={(e) => { playerState.fps = e.currentTarget.value; playerState.start() }}\n            />\n          </div>\n        </div>\n      );\n    }\n    \n    componentDidMount() {\n      playerState.start();\n    }\n\n    handleFullscreen(e) {\n      document.querySelector('.player-canvas').requestFullscreen();\n    }\n  }\n);\n\nexport default Player;\n","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { appState } from '../../appState';\r\n// import { appState, frames } from '../../appState';\r\n\r\nconst LayersList = observer(\r\n  class LayersList extends React.Component {\r\n    render() {\r\n      return (\r\n        <div \r\n          className=\"layers-list\"\r\n          onClick={this.handleClick}\r\n        >\r\n          {new Array(appState.layers).fill(null).map((layer, id) => {\r\n            return (\r\n            <div \r\n              className={\"layer-\" + id + (appState.currentLayer === id ? ' selected' : '')}\r\n              data-layer={id}\r\n              key={Math.random()}           \r\n            >\r\n              layer {id}\r\n            </div>\r\n            );\r\n          }).reverse()        \r\n          }\r\n        </div>\r\n      );\r\n    }\r\n\r\n    handleClick(e) {\r\n      e = e.nativeEvent;\r\n      if (e.target === e.currentTarget) return;\r\n      appState.currentLayer = +e.target.dataset.layer; \r\n    }\r\n  }\r\n);\r\n\r\nexport default LayersList;\r\n","import React from 'react';\nimport { observer } from 'mobx-react';\n// import { appState } from '../../appState';\nimport { appState, frames } from '../../appState';\nimport LayersList from './LayersList';\n\nconst Layers = observer(\n  class Layers extends React.Component {\n    render() {\n      return (\n        <div className=\"layers\">\n          <div className='component-name'>\n            <div>Layers</div>\n            <button \n              className={\"show-all-layers\" + (appState.onionSkin ? \" checked\" : \"\")}\n              onClick={() => {appState.onionSkin = !appState.onionSkin}}            \n            >&#128065;</button>\n          </div>\n          <div className=\"layers-control\" onClick={this.handleClick}>\n            <button className=\"layer-add\">+</button>\n            <button className=\"layer-up\">&#129093;</button>\n            <button className=\"layer-down\">&#129095;</button>\n            <button className=\"layer-delete\">&#10005;</button>\n          </div>\n          <LayersList />\n        </div>\n      );\n    }\n\n    handleClick(e) {\n      switch (e.target.className) {\n        case 'layer-add':\n          appState.addLayer();\n          break;\n\n        case 'layer-delete':\n          appState.deleteCurrentLayer();\n          break;\n\n        case 'layer-up':\n          frames.moveLayer(true);\n          break;\n\n        case 'layer-down':\n          frames.moveLayer(false);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n);\n\nexport default Layers;\n","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { appState } from '../../appState';\r\n// import { appState, frames } from '../../appState';\r\n\r\nconst LayerComposition = observer(\r\n  class LayerComposition extends React.Component {\r\n    render() {\r\n      const operators = [\r\n        'source-over',\r\n        'source-in',\r\n        'source-out',\r\n        'source-atop',\r\n        'destination-over',\r\n        'destination-in',\r\n        'destination-out',\r\n        'destination-atop',\r\n        'lighter',\r\n        'copy',\r\n        'xor',\r\n        'multiply',\r\n        'screen',\r\n        'overlay',\r\n        'darken',\r\n        'lighten',\r\n        'color-dodge',\r\n        'color-burn',\r\n        'hard-light',\r\n        'soft-light',\r\n        'difference',\r\n        'exclusion',\r\n        'hue',\r\n        'saturation',\r\n        'color',\r\n        'luminosity'\r\n      ]\r\n      return (\r\n        <div className='select-container'>\r\n          <p>Composition style</p>\r\n          <select \r\n            name=\"composite-style\" \r\n            id=\"composite-style\"\r\n            onChange={this.handleInput}\r\n          >\r\n            {operators.map((operator, id) => \r\n              <option \r\n                value={operator}\r\n                key={id }\r\n              >{operator}</option>\r\n            )}\r\n          </select>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    handleInput(e) {\r\n      appState.compositeOperation = e.target.value;\r\n    }\r\n  }\r\n);\r\n\r\nexport default LayerComposition;\r\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport drawApi from '../../drawApi';\n\nconst Transform = observer(\n  class Transform extends React.Component {\n    render() {\n      return (\n        <div className='transform-container'>\n          <p>Transform</p>\n          <div\n            className=\"transform-buttons\"\n            onClick={this.handleClick}\n          >\n            <button className=\"vertical-mirror\"></button>\n            <button className=\"horisontal-mirror\"></button>\n            <button className=\"rotate\"></button>\n          </div>\n        </div>\n      );\n    }\n\n    handleClick(e) {\n      switch (e.target.className) {\n        case \"vertical-mirror\":\n          drawApi.mirror(true);\n          break;\n\n        case \"horisontal-mirror\":\n          drawApi.mirror(false);\n          break;\n\n        case \"rotate\":\n          drawApi.rotate();\n          break;\n\n        default:\n          break;\n      }\n    }\n  }\n);\n\nexport default Transform;\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { appState } from '../../appState';\n\nconst CanvasInfo = observer(\n  class CanvasInfo extends React.Component {\n    render() {\n      return (\n        <div \n          className=\"canvas-info\"\n        >\n          <p>Mouse position: <span>{appState.x} : {appState.y}</span></p>\n          <p>Canvas size: <span>{appState.size}x{appState.size}</span></p>\n          <p>Current layer: <span>{appState.currentLayer}</span></p>\n          <p>Current frame: <span>{appState.currentFrame + 1}</span></p>\n        </div>\n      );\n    }\n  }\n);\n\nexport default CanvasInfo;\n","import React from 'react';\r\nimport { observer } from 'mobx-react';\r\n// import { appState, frames } from '../appState';\r\nimport { Player, Layers, LayerComposition, Transform, CanvasInfo } from './layerpad_comp/';\r\nimport './LayerPad.css';\r\n\r\nconst LayerPad = observer(\r\n  class LayerPad extends React.Component {\r\n    render() {\r\n      return (\r\n        <section className=\"layer-pad\">\r\n          <Player />\r\n          <Layers />\r\n          <LayerComposition />\r\n          <Transform />\r\n          <CanvasInfo />\r\n        </section>\r\n      );\r\n    }\r\n  }\r\n);\r\n\r\nexport default LayerPad;\r\n","import React from 'react';\r\nimport { appState } from '../appState';\r\nimport './Menu.css';\r\n// import drawApi from '../drawApi';\r\nimport { observer } from 'mobx-react';\r\n\r\nconst Menu = observer(\r\n  class Menu extends React.Component {\r\n    render() {\r\n      return (\r\n        <section className=\"menu\">\r\n          <button\r\n            className=\"canvas-size\"\r\n            data-size={appState.size}\r\n            onClick={this.handleChangeSize}\r\n          >{appState.size}</button>\r\n          <button\r\n            className=\"export\"\r\n            onClick={this.handleExport}\r\n          ></button>\r\n        </section>\r\n      );\r\n    }\r\n\r\n\r\n    handleChangeSize(e) {\r\n      const size = +e.currentTarget.dataset.size;\r\n      if (size === 32) {\r\n        appState.scale /= 2;\r\n        appState.size = 64;\r\n      } else if (size === 64) {\r\n        appState.scale /= 2;\r\n        appState.size = 128;\r\n      } else {\r\n        appState.scale *= 4;\r\n        appState.size = 32;\r\n      }\r\n    }\r\n\r\n    handleExport(e) {\r\n      appState.exportWindow = true;\r\n    }\r\n  }\r\n);\r\n\r\nexport default Menu;\r\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { appState, encoder } from '../appState';\nimport './ExportWindow.css';\n\nconst ExportWindow = observer(\n  class ExportWindow extends React.Component {\n    render() {\n      return (\n        <div\n          className={\"export-window-overlay\" + (appState.exportWindow ? ' active' : '')}\n          onClick={this.handleClose}\n        >\n\n          <form\n            className=\"export-window\"\n            onSubmit={this.handleSubmit}\n          >\n            <legend>Export animation</legend>\n            <label htmlFor=\"export-name\">\n              File name:\n            <input\n                type=\"text\"\n                name=\"export-name\"\n                id=\"export-name\"\n                value={encoder.name}\n                onChange={this.handleNameChange}\n              />\n            </label>\n\n            <label htmlFor=\"export-format\">\n              Export format:\n            <select\n                name=\"export-format\"\n                id=\"export-format\"\n                onChange={this.handleFormatChange}\n              >\n                <option value=\"gif\">gif</option>\n                <option value=\"psk\">psk</option>\n                <option value=\"apng\">apng</option>\n              </select>\n            </label>\n\n            <label htmlFor=\"export-fps\">\n              FPS: {encoder.fps}\n              <input\n                type=\"range\"\n                name=\"export-fps\"\n                id=\"export-fps\"\n                min={1}\n                max={60}\n                value={encoder.fps}\n                onChange={this.handleFPSChange}\n              />\n            </label>\n\n            <label htmlFor=\"export-size\">\n              Size: {encoder.size}x{encoder.size}\n              <input\n                type=\"range\"\n                name=\"export-size\"\n                id=\"export-size\"\n                min={32}\n                max={1024}\n                step={32}\n                value={encoder.size}\n                onChange={this.handleSizeChange}\n              />\n            </label>\n\n            <label htmlFor=\"export-background-color\">\n              Background color:\n            <input\n                type=\"color\"\n                name=\"export-background-color\"\n                id=\"export-background-color\"\n                onInput={this.handleBackgroundColorChange}\n              />\n            </label>\n            <div\n              id=\"encoder-close\"\n              onClick={this.handleCloseWindow}\n            >X</div>\n            <button type=\"submit\" id='export-submit-button'>Export</button>\n          </form>\n        </div>\n      );\n    }\n\n    handleSubmit(e) {\n      e.preventDefault();\n      console.log('EXPORT');\n      appState.exportWindow = false;\n      switch (encoder.format) {\n        case \"gif\":\n          encoder.exportGif();\n          break;\n\n        case \"psk\":\n          encoder.exportPSK();\n          break;\n\n        case \"apng\":\n          encoder.exportAPNG();\n          break;\n        default:\n          break;\n      }\n    }\n\n    handleNameChange(e) {\n      encoder.name = e.target.value;\n    }\n\n    handleFormatChange(e) {\n      encoder.format = e.target.value;\n    }\n\n    handleFPSChange(e) {\n      encoder.fps = e.target.value;\n    }\n\n    handleSizeChange(e) {\n      encoder.size = e.target.value;\n    }\n\n    handleBackgroundColorChange(e) {\n      encoder.backgroundColor = e.target.value;\n    }\n\n    handleCloseWindow() {\n      appState.exportWindow = false;\n    }\n\n    handleClose(e) {\n      if (e.target.classList.contains('export-window-overlay')) {\n        appState.exportWindow = false;\n      }\n    }\n  }\n);\n\nexport default ExportWindow;\n","import { extendObservable } from 'mobx';\n\nclass KeyBind {\n  constructor() {\n    extendObservable(this, {\n      pen: 'KeyP',\n      mirrorPen: 'KeyA',\n      paintBucket: 'KeyS',\n      sameColorPixel: 'KeyD',\n      eraser: 'KeyF',\n      stroke: 'KeyG',\n      circle: 'KeyH',\n      rectangle: 'KeyJ',\n      move: 'KeyK',\n      lightenDarken: 'KeyR',\n      dither: 'KeyT',\n      colorPicker: 'KeyY',\n      smoothPen: 'KeyN',\n    });\n  }\n}\n\nconst keyBind = new KeyBind();\n\nexport default keyBind;\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { appState } from '../appState';\nimport keyBind from '../keyBind';\nimport './KeyBindWindow.css';\n\nconst KeyBindWindow = observer(\n  class KeyBindWindow extends React.Component {\n    render() {\n      const tools = [\n        'pen',\n        'mirrorPen',\n        'paintBucket',\n        'sameColorPixel',\n        'eraser',\n        'stroke',\n        'circle',\n        'rectangle',\n        'move',\n        'lightenDarken',\n        'dither',\n        'colorPicker',\n        'smoothPen',\n      ];\n      return (\n        <div\n          className={\"key-bind-overlay\" + (appState.keyBindWindow ? ' active' : '')}\n          onClick={this.handleClosingClick}\n        >\n          <div className=\"key-bind-window\">\n            <div \n              className=\"key-bind-container\"\n              onClick={this.handleBindClick}\n            >\n\n              {\n                tools.map((tool, id) =>\n                  <div\n                    data-key={keyBind[tool]}\n                    data-tool={tool}\n                    key={id}\n                  >\n                    <div className={tool + '-image'}></div>\n                    <p className={appState.activeBindKey.tool === tool ? 'active' : ''}\n                    >{keyBind[tool]}</p>\n                  </div>\n                )\n              }\n            </div>\n\n            <button\n              className=\"close-window\"\n              onClick={() => { appState.keyBindWindow = false }}\n            >X</button>\n          </div>\n        </div>\n      );\n    }\n\n    handleBindClick(e) {\n      const target = e.target.closest('[data-key]');\n      const tool = target.dataset.tool;\n      const oldKey = target.dataset.key;\n      appState.activeBindKey = { target: target, tool: tool, oldKey: oldKey };\n      \n      window.onkeypress = (e) => {\n        e.stopPropagation();\n        switch (e.code) {\n          case `Tab`:\n          case `CapsLock`:\n          case `Escape`:\n          case `ShiftLeft`:\n          case `ControlLeft`:\n          case `ShiftRight`:\n          case `ControlRight`:\n          case `Enter`:\n          case `Backspace`:\n          case `ScrollLock`:\n          case `Pause`:\n          case `Insert`:\n          case `Home`:\n          case `PageUp`:\n          case `PageDown`:\n          case `Delete`:\n          case `End`:\n          case `NumLock`:\n          case `NumpadEnter`:\n          case `MetaLeft`:\n          case `MetaRight`:\n          case `ContextMenu`:\n          case `AltLeft`:\n          case `AltRight`:\n            keyBind[appState.activeBindKey.tool] = oldKey;\n            break;\n\n          default:\n            const newKey = e.code;\n            for (let key in keyBind) {\n              if (keyBind[key] === newKey) keyBind[key] = '..';\n            }\n            keyBind[appState.activeBindKey.tool] = newKey;\n            break;\n        }\n        appState.activeBindKey = { target: null, tool: null, oldKey: null };\n        window.onkeypress = null;\n      }\n    }\n\n    handleClosingClick(e) {\n      if (e.target.classList.contains('key-bind-overlay')) {\n        appState.keyBindWindow = false;\n        window.onkeypress = null;\n      }\n    }\n\n\n  }\n);\n\nexport default KeyBindWindow;\n","import FramePad from './FramePad';\r\n\r\nexport default FramePad;\r\n","import React from 'react';\nimport './FramePad.css';\nimport { observer } from 'mobx-react';\nimport { appState, frames } from '../../appState';\n\n\nconst FramePad = observer(\n  class FramePad extends React.Component {\n\n    render() {\n      console.log(`RENDER STARTED`, JSON.stringify(frames.data).slice(0, 0), appState.currentLayer);\n      return (\n        <section \n          className='frame-pad'\n\n        >\n          {frames.order.map(\n            (id, number) =>\n              <div\n                className={'frame' + (number === appState.currentFrame ? ' selected' : '')}\n                key={Math.random()}\n                id={id}\n                draggable={true}\n                onClick={this.handleFrameDiv}\n              >\n                <button className=\"delete-frame\"></button>\n                <button className=\"duplicate-frame\"></button>\n                <div className=\"number-frame\" data-idx={number}>{number + 1}</div>\n                <canvas\n                  width={appState.size}\n                  height={appState.size}\n                  ref={(canvas) => {this.handleCanvasRender(canvas, frames.data[id])}}\n                ></canvas>                \n              </div>\n          )}\n          <button\n            className='add-frame'\n            onClick={this.handleAddFrame}\n          >+</button>\n        </section>\n      );\n    }\n\n    componentDidMount() {\n      frames.addFrame(null);\n\n      const dropZone = document.querySelector('.frame-pad');\n      let startId;\n      \n      dropZone.ondragstart = (event) => {\n        startId = event.target.getAttribute('id');\n      };\n  \n      dropZone.ondragenter = (event) => {\n        if (event.target.parentElement.classList.contains('frame')) {\n          event.target.parentElement.classList.add('drag-hovered');\n        }\n      };\n  \n      dropZone.ondragleave = (event) => {\n        if (event.target.parentElement.classList.contains('frame')) {\n          event.target.parentElement.classList.remove('drag-hovered');\n        }\n      };\n  \n      dropZone.ondragover = e => e.preventDefault();\n  \n      dropZone.ondrop = (event) => {\n        const div = event.target.closest('[draggable]');\n        const targetId = div.getAttribute('id');\n  \n        event.preventDefault();\n        div.classList.remove('drag-hovered');\n\n        frames.switchFrames(startId, targetId);\n      };\n\n    }\n\n    handleCanvasRender(cnv, data) {\n      if(!cnv) return;\n      const ctx = cnv.getContext('2d');\n      ctx.clearRect(0, 0, cnv.width, cnv.height);\n      const curLayer = data[appState.currentLayer];\n      if(!curLayer) return;\n      ctx.putImageData(curLayer, 0, 0);\n    }\n\n    handleFrameDiv(e) {\n      const frame = e.currentTarget;\n      switch (e.target.className) {\n        case \"delete-frame\":\n          frames.deleteFrame(frame.id);\n          break;\n\n        case \"duplicate-frame\":\n          const data = frames.getData(frame.id)\n          const index = frames.order.indexOf(frame.id)\n          frames.addFrame(data, index + 1);\n          break;\n\n        default:\n          const div = frame.querySelector('.number-frame');\n          const value = +div.getAttribute('data-idx');\n          appState.currentFrame = value;\n          break;\n      }\n    }\n\n\n    handleAddFrame() {\n      frames.addFrame();\n    }\n  }\n);\n\nexport default FramePad;\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { GoogleLogout, GoogleLogin } from 'react-google-login';\nimport { appState } from '../appState';\n\nconst responseGoogle = (response) => {\n  console.log(response);\n}\n\nconst user = {\n  name: null,\n  surname: null,\n  imageUrl: null,\n}\n\nconst Login = observer(\n  class Login extends React.Component {\n    render() {\n      if (appState.logIn) {\n        return (\n          <div className=\"logged-on\">\n            <GoogleLogout\n              render={renderProps => (\n                <button\n                  onClick={renderProps.onClick}\n                  disabled={renderProps.disabled}\n                  className='logout-button'\n                >Log out</button>\n              )}\n              buttonText=\"Logout\"\n              onLogoutSuccess={() => { \n                appState.logIn = false \n                user.name = null;\n                user.surname = null;\n                user.imageUrl = null;\n              }}\n            >\n            </GoogleLogout>\n            <div className=\"user-info\">\n              <img \n                className='user-picture' \n                src={user.imageUrl} \n                alt=\"user avatar\"\n                width={30}\n                height={30}\n              />\n              <p className=\"user-name\">\n                {user.name}\n              </p>\n            </div>\n          </div>\n        );\n      } else {\n        return (\n          <GoogleLogin\n            clientId=\"793758825150-1ihng8falh4dik8c9q6aig2db68dh7v8.apps.googleusercontent.com\"\n            render={renderProps => (\n              <button\n                onClick={renderProps.onClick}\n                disabled={renderProps.disabled}\n                className='login-button'\n              >Sign up with Google</button>\n            )}\n            buttonText=\"Login\"\n            onSuccess={(resp) => {\n              responseGoogle(resp);\n              user.name = resp.profileObj.givenName;\n              user.surname = resp.profileObj.familyName;\n              user.imageUrl = resp.profileObj.imageUrl;\n              appState.logIn = true;\n            }}\n            onFailure={responseGoogle}\n            cookiePolicy={'single_host_origin'}\n          />\n        );\n      }\n    }\n  }\n);\n\nexport default Login;\n","import React from 'react';\r\nimport Login from './Login';\r\nimport './HeadPad.css';\r\n\r\nclass HeadPad extends React.Component {\r\n  render() {\r\n    return (\r\n      <header>\r\n        <h1>PiSKEL</h1>\r\n        <h2>{this.props.name}</h2>\r\n        <div className='header-buttons'>\r\n          <button className=\"create-sprite\">Create Sprite</button>\r\n          <Login />\r\n        </div>\r\n      </header>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HeadPad;\r\n","import React from 'react';\r\n// import CanvasPad from './screens/canvas/';\r\n// import { ToolPad, LayerPad, Menu } from './tools';\r\n// import FramePad from './components/frames.list';\r\n// import HeadPad from './components/HeadPad';\r\nimport { observer } from 'mobx-react';\r\nimport { appState } from './appState';\r\n\r\n\r\nconst Landing = observer(\r\n  class Landing extends React.Component {\r\n    render() {\r\n      return (\r\n        <>\r\n          <main className=\"landing-box\">\r\n            <div className=\"landing-screenshot\"></div>\r\n            <div className=\"landing-info\">\r\n              <h1 className=\"landing-h1\">PiSKEL clone</h1>\r\n              <p className=\"landing-p\">Perfect application for\r\n                creating and editing pixelated sprites</p>\r\n              <button\r\n                className=\"landing-button\"\r\n                onClick={() => { appState.landing = false }}\r\n              >Create your Sprite</button>\r\n            </div>\r\n          </main>\r\n        </>\r\n      );\r\n    }\r\n  }\r\n);\r\n\r\nexport default Landing;\r\n","import React from 'react';\nimport CanvasPad from './screens/canvas/';\nimport { ToolPad, LayerPad, Menu, ExportWindow } from './tools';\nimport FramePad from './components/frames.list';\nimport HeadPad from './components/HeadPad';\nimport { observer } from 'mobx-react';\nimport { toJS } from 'mobx';\nimport { appState } from './appState';\nimport keyBind from './keyBind';\nimport drawApi from './drawApi';\nimport Landing from './Landing';\nimport KeyBindWindow from './tools/KeyBindWindow';\n\nfunction unload2() {\n  const keyBindStr = toJS(keyBind);\n\n  localStorage.setItem('keyBind', JSON.stringify(keyBindStr));\n}\n\nconst App = observer(\n  class App extends React.Component {\n    render() {\n      if (appState.landing) {\n        return (\n          <>\n            <Landing />\n          </>\n        );\n      } else {\n        return (\n          <>\n            <HeadPad name='New Piskel *' />\n            <main>\n              <ToolPad />\n              <FramePad />\n              <CanvasPad />\n              <LayerPad />\n              <Menu />\n            </main>\n            <ExportWindow />\n            <KeyBindWindow />\n          </>\n        );\n      }\n\n    }\n\n    componentDidMount() {\n      window.addEventListener('keypress', this.keySwitcher);\n\n      if (localStorage.getItem('keyBind')) {\n        const keyBindStr = JSON.parse(localStorage.getItem('keyBind'));\n\n        for (let prop in keyBindStr) {\n          keyBind[prop] = keyBindStr[prop];\n        }\n      }\n      \n      window.onunload = unload2;\n    }\n\n    componentWillUnmount() {\n      unload2();\n    }\n\n    keySwitcher(e) {\n      console.log(keyBind.pen);\n      switch (e.code) {\n        case keyBind.pen:\n          drawApi.selectedTool = 'pen';\n          break;\n        case keyBind.mirrorPen:\n          drawApi.selectedTool = 'mirror-pen';\n          break;\n\n        case keyBind.eraser:\n          drawApi.selectedTool = 'eraser';\n          break;\n\n        case keyBind.paintBucket:\n          drawApi.selectedTool = 'paint-bucket';\n          break;\n\n        case keyBind.colorPicker:\n          drawApi.selectedTool = 'color-picker';\n          break;\n\n        case keyBind.sameColorPixel:\n          drawApi.selectedTool = 'same-color-pixel';\n          break;\n\n        case keyBind.stroke:\n          drawApi.selectedTool = 'stroke';\n          break;\n\n        case keyBind.circle:\n          drawApi.selectedTool = 'circle';\n          break;\n\n        case keyBind.rectangle:\n          drawApi.selectedTool = 'rectangle';\n          break;\n\n        case keyBind.move:\n          drawApi.selectedTool = 'move';\n          break;\n\n        case keyBind.dither:\n          drawApi.selectedTool = 'dither';\n          break;\n\n        case keyBind.lightenDarken:\n          drawApi.selectedTool = 'lighten-darken';\n          break;\n\n        case keyBind.smoothPen:\n          drawApi.selectedTool = 'smooth-pen';\n          break;\n\n        default:\n          break;\n      }\n    }\n  }\n);\n\nexport default App;\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './App.css';\nimport './fonts/fontello.css';\nimport './tools/ToolPad.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}